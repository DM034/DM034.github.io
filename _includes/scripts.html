    <!-- core  -->
    <script src="assets/vendors/jquery/jquery-3.4.1.js"></script>
    <script src="assets/vendors/bootstrap/bootstrap.bundle.js"></script>

    <!-- bootstrap 3 affix -->
    <script src="assets/vendors/bootstrap/bootstrap.affix.js"></script>

    <!-- Isotope  -->
    <script src="assets/vendors/isotope/isotope.pkgd.js"></script>

    <!-- Google mpas -->


    <!-- JohnDoe js -->
    <script src="assets/js/johndoe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="assets/js/translations.js"></script>

    <script>
        (function () {
            const translations = window.siteTranslations || {};

            const getActiveLanguage = () => {
                const languageSelect = document.getElementById('languageSelect');
                const selected = languageSelect ? languageSelect.value : null;
                const saved = localStorage.getItem('siteLanguage');
                if (selected && translations[selected]) {
                    return selected;
                }
                if (saved && translations[saved]) {
                    return saved;
                }
                return 'fr';
            };

            const setText = (selector, value) => {
                const element = document.querySelector(selector);
                if (element) {
                    element.textContent = value;
                }
            };

            const setHtml = (selector, value) => {
                const element = document.querySelector(selector);
                if (element) {
                    element.innerHTML = value;
                }
            };

            const setAttr = (selector, attribute, value) => {
                const element = document.querySelector(selector);
                if (element) {
                    element.setAttribute(attribute, value);
                }
            };

            const getTextList = (selector) => {
                return Array.from(document.querySelectorAll(selector))
                    .map((node) => node.textContent ? node.textContent.trim() : '')
                    .filter((value) => value.length > 0);
            };

            const appendSectionTitle = (container, value) => {
                const heading = document.createElement('h2');
                heading.textContent = value;
                heading.style.fontSize = '18px';
                heading.style.margin = '18px 0 8px 0';
                heading.style.borderBottom = '1px solid #dddddd';
                heading.style.paddingBottom = '4px';
                container.appendChild(heading);
            };

            const buildCvPdfLines = (text) => {
                const lines = [];
                const pushLine = (value = '', style = 'normal') => {
                    lines.push({ value, style });
                };

                // Header: Name and title (no extra line)
                pushLine('Michael Raharison', 'title');
                pushLine('Développeur Java | Coordinateur de Projet', 'subtitle');
                pushLine('michael@example.com | +261 34 XX XX XX | linkedin.com/in/michael-raharison', 'contact');
                pushLine('');

                // Experience
                pushLine('EXPÉRIENCE PROFESSIONNELLE', 'section');
                pushLine('');
                
                // Exp 1
                pushLine('Développeur Java - BICI (Projet ASYNC)', 'bold');
                pushLine('Août 2025 - Présent', 'date');
                pushLine('');

                // Exp 2
                pushLine('Coordinateur de Projet - BICI', 'bold');
                pushLine('Avril 2025 - Juillet 2025', 'date');
                pushLine('');

                // Exp 3
                pushLine('Manager Devis Impression - Grafiky (BICI)', 'bold');
                pushLine('Juin 2024 - Avril 2025', 'date');
                pushLine('');

                // Exp 4
                pushLine('Gestionnaire de tâches embarqué - ASTEK', 'bold');
                pushLine('Juin 2024 - Août 2024', 'date');
                pushLine('');

                // Education
                pushLine('FORMATION ACADEMIQUE', 'section');
                pushLine('');
                
                pushLine('MBDS - Master 2 en Développement Informatique', 'bold');
                pushLine('Octobre 2025 - Présent', 'date');
                pushLine('');
                
                pushLine('Master 1 - Développement Informatique', 'bold');
                pushLine('Décembre 2024 - Septembre 2025', 'date');
                pushLine('');
                
                pushLine('Licence - Développement Informatique', 'bold');
                pushLine('2021 - Juin 2024', 'date');
                pushLine('');

                // Skills
                pushLine('COMPETENCES TECHNIQUES', 'section');
                pushLine('');
                
                pushLine('Langages  Java • SQL • C++ • JavaScript • QML', 'skills');
                pushLine('Bases de Données  PostgreSQL • Oracle • MySQL', 'skills');
                pushLine('Outils & Frameworks  APJ • Bootstrap • Git • Agile/Scrum', 'skills');
                pushLine('');

                // Languages
                pushLine('LANGUES', 'section');
                pushLine('');
                pushLine('Français (Natif) • Anglais (Courant)', 'skills');
                
                return lines;
            };

            const buildCvPdfHtml = (lines) => {
                const container = document.createElement('div');
                container.style.background = '#ffffff';
                container.style.color = '#1a1a1a';
                container.style.fontFamily = '"Segoe UI", Tahoma, Geneva, Verdana, sans-serif';
                container.style.padding = '30px';
                container.style.width = '750px';
                container.style.lineHeight = '1.5';
                container.style.maxWidth = '100%';

                lines.forEach((line, index) => {
                    const value = line.value || '';
                    
                    if (!value) {
                        const spacer = document.createElement('div');
                        spacer.style.height = '8px';
                        container.appendChild(spacer);
                        return;
                    }

                    const node = document.createElement('div');
                    node.textContent = value;
                    node.style.margin = '0';

                    if (line.style === 'title') {
                        node.style.fontSize = '32px';
                        node.style.fontWeight = '700';
                        node.style.marginBottom = '3px';
                        node.style.color = '#0066cc';
                        node.style.letterSpacing = '-0.5px';
                    } else if (line.style === 'subtitle') {
                        node.style.fontSize = '14px';
                        node.style.color = '#666666';
                        node.style.fontWeight = '500';
                        node.style.marginBottom = '8px';
                        node.style.letterSpacing = '0.5px';
                    } else if (line.style === 'contact') {
                        node.style.fontSize = '11px';
                        node.style.color = '#555555';
                        node.style.marginBottom = '12px';
                        node.style.borderBottom = '2px solid #0066cc';
                        node.style.paddingBottom = '8px';
                    } else if (line.style === 'section') {
                        node.style.fontSize = '13px';
                        node.style.fontWeight = '700';
                        node.style.color = '#ffffff';
                        node.style.background = '#0066cc';
                        node.style.padding = '6px 10px';
                        node.style.marginTop = '12px';
                        node.style.marginBottom = '8px';
                        node.style.letterSpacing = '0.5px';
                    } else if (line.style === 'bold') {
                        node.style.fontWeight = '700';
                        node.style.fontSize = '12px';
                        node.style.color = '#1a1a1a';
                        node.style.marginTop = '6px';
                    } else if (line.style === 'date') {
                        node.style.fontSize = '11px';
                        node.style.color = '#0066cc';
                        node.style.fontStyle = 'italic';
                        node.style.marginBottom = '4px';
                    } else if (line.style === 'skills') {
                        node.style.fontSize = '11px';
                        node.style.color = '#333333';
                        node.style.marginBottom = '4px';
                        node.style.lineHeight = '1.6';
                    } else {
                        node.style.fontSize = '11px';
                        node.style.color = '#333333';
                        node.style.marginBottom = '2px';
                    }

                    container.appendChild(node);
                });

                return container;
            };

            const extractCvDataFromSite = (text, language) => {
                const profileName = document.querySelector('.header-title')?.textContent?.trim() || 'Michael Raharison';
                const profileRole = document.querySelector('.header-mono')?.textContent?.trim() || (language === 'en' ? 'Developer' : 'Développeur');

                const contactLines = Array.from(document.querySelectorAll('.contact-info-card .d-inline'))
                    .map((node) => node.textContent ? node.textContent.replace(/\s+/g, ' ').trim() : '')
                    .filter(Boolean);

                const experiences = Array.from(document.querySelectorAll('#resume .experience-list .experience-item')).map((item) => ({
                    role: item.querySelector('.exp-role')?.textContent?.trim() || '',
                    date: item.querySelector('.exp-date')?.textContent?.trim() || '',
                    bullets: Array.from(item.querySelectorAll('.exp-bullets li'))
                        .map((li) => li.textContent ? li.textContent.trim() : '')
                        .filter(Boolean)
                })).filter((item) => item.role || item.date);

                const educationCard = document.querySelector('#resume .col-md-6.col-lg-4:nth-child(2) .card-body');
                const education = [];
                if (educationCard) {
                    const dateNodes = Array.from(educationCard.querySelectorAll('h6.title.text-danger'));
                    dateNodes.forEach((dateNode) => {
                        let cursor = dateNode.nextElementSibling;
                        while (cursor && cursor.tagName.toLowerCase() !== 'p') {
                            cursor = cursor.nextElementSibling;
                        }
                        education.push({
                            title: cursor?.textContent?.trim() || '',
                            date: dateNode.textContent?.trim() || ''
                        });
                    });
                }

                const allSkillTexts = Array.from(document.querySelectorAll('#resume .row > .col-lg-4:last-child .card .card-body h6'))
                    .map((node) => node.textContent ? node.textContent.trim() : '')
                    .filter(Boolean);

                const techRegex = /^(Java|C\+\+|C#|\.NET|PostgreSQL|Oracle|MySQL|Linux|Git)$/i;
                const skillItems = allSkillTexts.filter((value) => techRegex.test(value));

                const spokenLanguages = [text.langFrench, text.langEnglish, text.langMalagasy].filter(Boolean);

                const softSkills = Array.from(document.querySelectorAll('#about .about-card:last-child ul li'))
                    .map((node) => node.textContent ? node.textContent.trim() : '')
                    .filter(Boolean);

                const imageNode = document.querySelector('.header .img-holder img') || document.querySelector('img[src*="avatar"]');
                const profileImageSrc = imageNode?.currentSrc || imageNode?.src || imageNode?.getAttribute('src') || 'assets/imgs/avatar.jpg';
                const absoluteAvatar = (window.location?.origin || '') + '/assets/imgs/avatar.jpg';
                const profileImageCandidates = [
                    profileImageSrc,
                    absoluteAvatar,
                    'assets/imgs/avatar.jpg',
                    '/assets/imgs/avatar.jpg',
                    './assets/imgs/avatar.jpg'
                ].filter(Boolean);

                const linkedInRaw = contactLines.find((line) => /linkedin/i.test(line));
                const linkedInLine = linkedInRaw
                    ? linkedInRaw.replace(/^linkedin\s*[:\-]?\s*/i, '').trim()
                    : 'Michael Raharison';

                const linkedInHref = document.querySelector('a[href*="linkedin.com/in/"]')?.getAttribute('href')
                    || document.querySelector('a[href*="linkedin.com"]')?.getAttribute('href')
                    || 'https://www.linkedin.com/in/michael-raharison-215901288';

                const phoneRaw = contactLines.find((line) => /phone|t[eé]l[eé]phone/i.test(line));
                const phoneLine = phoneRaw
                    ? phoneRaw.replace(/^(phone|t[eé]l[eé]phone)\s*[:\-]?\s*/i, '').trim()
                    : '+261 32 49 084 09';

                const phoneDigits = phoneLine.replace(/[^\d+]/g, '');
                const normalizedPhone = phoneDigits.startsWith('+') ? phoneDigits.slice(1) : phoneDigits;
                const whatsappHref = 'https://wa.me/' + (normalizedPhone || '261324908409');

                const emailRaw = contactLines.find((line) => /@/.test(line));
                const emailLine = emailRaw
                    ? emailRaw.replace(/^email\s*[:\-]?\s*/i, '').trim()
                    : 'michaeldm034@gmail.com';

                return {
                    profileName,
                    profileRole,
                    profileImageSrc,
                    profileImageCandidates,
                    contactLines,
                    phoneLine,
                    whatsappHref,
                    linkedInLine,
                    linkedInHref,
                    emailLine,
                    experiences,
                    education,
                    softSkills,
                    skillsLine: skillItems.join(', '),
                    spokenLanguagesLine: (spokenLanguages.length ? spokenLanguages : [text.langFrench, text.langEnglish, text.langMalagasy]).join(', ')
                };
            };

            const generateCvPdf = (lang) => {
                const language = translations[lang] ? lang : 'fr';
                const text = translations[language];

                if (!window.jspdf || !window.jspdf.jsPDF) {
                    alert('Erreur: jsPDF non disponible');
                    return;
                }

                tryJsPdfGenerate(text, language);
            };

            const tryJsPdfGenerate = (text, language) => {
                try {
                    
                    // Debug: Check what's available
                    
                    if (!window.jspdf || !window.jspdf.jsPDF) {
                        throw new Error('jsPDF library not available on window.jspdf.jsPDF');
                    }

                    // Create PDF with correct syntax
                    const pdf = new window.jspdf.jsPDF({ 
                        orientation: 'portrait',
                        unit: 'mm', 
                        format: 'a4'
                    });

                    const pageWidth = pdf.internal.pageSize.getWidth();
                    const pageHeight = pdf.internal.pageSize.getHeight();
                    const margin = 3;
                    const top = 12;
                    const leftColWidth = 68;
                    const colGap = 6;
                    const rightColWidth = pageWidth - (margin * 2) - leftColWidth - colGap;
                    const leftX = margin;
                    const rightX = leftX + leftColWidth + colGap;

                    const addSectionHeader = (title, x, y, width) => {
                        pdf.setFillColor(25, 101, 207);
                        pdf.rect(x, y - 4, width, 5, 'F');
                        pdf.setTextColor(255, 255, 255);
                        pdf.setFont('helvetica', 'bold');
                        pdf.setFontSize(8.7);
                        pdf.text(title, x + 2, y - 0.2);
                        return y + 4;
                    };

                    const addWrapped = (value, x, y, width, font = 'normal', size = 8.3, color = [38, 44, 56], lineHeight = 3.9) => {
                        pdf.setFont('helvetica', font);
                        pdf.setFontSize(size);
                        pdf.setTextColor(color[0], color[1], color[2]);
                        const split = pdf.splitTextToSize(value, width - 4);
                        pdf.text(split, x + 2, y);
                        return y + (split.length * lineHeight);
                    };

                    const addBullets = (items, x, y, width) => {
                        let currentY = y;
                        items.forEach((item) => {
                            currentY = addWrapped('· ' + item, x, currentY, width, 'normal', 8.3, [38, 44, 56], 3.8);
                        });
                        return currentY;
                    };

                    const addPlainList = (items, x, y, width) => {
                        let currentY = y;
                        items.forEach((item) => {
                            currentY = addWrapped(item, x, currentY, width, 'normal', 8.3, [38, 44, 56], 3.8);
                        });
                        return currentY;
                    };

                    const addLabelWithLinkValue = (label, value, href, x, y, width) => {
                        const left = x + 2;
                        const line = y;

                        pdf.setFont('helvetica', 'normal');
                        pdf.setFontSize(8.3);
                        pdf.setTextColor(28, 34, 44);

                        const labelText = (label || '') + ' : ';
                        pdf.text(labelText, left, line);

                        const labelWidth = pdf.getTextWidth(labelText);
                        const valueMaxWidth = Math.max(10, width - 6 - labelWidth);
                        const valueParts = pdf.splitTextToSize(value || '', valueMaxWidth);

                        if (valueParts.length > 0) {
                            pdf.setTextColor(20, 88, 185);
                            pdf.textWithLink(valueParts[0], left + labelWidth, line, { url: href });
                            for (let index = 1; index < valueParts.length; index += 1) {
                                pdf.text(valueParts[index], left, line + (index * 3.8));
                            }
                        }

                        return line + (Math.max(1, valueParts.length) * 3.8);
                    };

                    const normalizeImageToDataUrl = (url) => {
                        return new Promise((resolve) => {
                            if (!url) {
                                resolve(null);
                                return;
                            }
                            const img = new Image();
                            img.crossOrigin = 'anonymous';
                            img.onload = function () {
                                try {
                                    const canvas = document.createElement('canvas');
                                    const targetW = 220;
                                    const targetH = 160;
                                    canvas.width = targetW;
                                    canvas.height = targetH;
                                    const ctx = canvas.getContext('2d');

                                    const sourceW = img.naturalWidth;
                                    const sourceH = img.naturalHeight;
                                    const sourceRatio = sourceW / sourceH;
                                    const targetRatio = targetW / targetH;

                                    let cropW = sourceW;
                                    let cropH = sourceH;
                                    let cropX = 0;
                                    let cropY = 0;

                                    if (sourceRatio > targetRatio) {
                                        cropW = sourceH * targetRatio;
                                        cropX = (sourceW - cropW) / 2;
                                    } else {
                                        cropH = sourceW / targetRatio;
                                        cropY = (sourceH - cropH) / 2;
                                    }

                                    ctx.drawImage(img, cropX, cropY, cropW, cropH, 0, 0, targetW, targetH);
                                    resolve(canvas.toDataURL('image/jpeg', 0.92));
                                } catch (_) {
                                    resolve(null);
                                }
                            };
                            img.onerror = function () { resolve(null); };
                            img.src = url;
                        });
                    };

                    const resolveFirstImage = (candidates) => {
                        const sources = Array.isArray(candidates) && candidates.length ? candidates : [null];
                        return sources.reduce((promise, current) => {
                            return promise.then((resolved) => {
                                if (resolved) {
                                    return resolved;
                                }
                                return normalizeImageToDataUrl(current);
                            });
                        }, Promise.resolve(null));
                    };

                    const addDateBadge = (value, x, y, width) => {
                        const label = value || '';
                        if (!label) {
                            return y;
                        }

                        pdf.setFont('helvetica', 'bold');
                        pdf.setFontSize(8.2);
                        const textW = pdf.getTextWidth(label);
                        const badgeW = Math.min(width - 4, Math.max(24, textW + 4));

                        pdf.setFillColor(225, 236, 255);
                        pdf.rect(x + 2, y - 2.8, badgeW, 4.6, 'F');
                        pdf.setTextColor(20, 88, 185);
                        pdf.text(label, x + 3.2, y + 0.2);
                        return y + 4.8;
                    };

                    const data = extractCvDataFromSite(text, language);

                    const sectionSkills = language === 'en' ? 'Skills' : 'Compétences';
                    const sectionTech = language === 'en' ? 'Tech Stack' : 'Tech Stack';
                    const sectionSpoken = language === 'en' ? 'Spoken Languages' : 'Langues parlées';
                    const sectionContact = language === 'en' ? 'Get in touch' : 'Contact';
                    const sectionExperience = language === 'en' ? 'Expertise' : 'Expertise';
                    const sectionEducation = language === 'en' ? 'Education' : 'Formation';

                    const profileTitle = language === 'en' ? 'Developer' : 'Développeur';
                    const softSkills = data.softSkills.length
                        ? data.softSkills
                        : ['Communication', 'Teamwork', 'Problem solving', 'Adaptability', 'Time management'];

                    const techItems = (data.skillsLine || 'Java, C++, C#, .NET, PostgreSQL, Oracle, MySQL, Linux, Git')
                        .split(',')
                        .map((s) => s.trim())
                        .filter(Boolean);

                    const spokenItems = (data.spokenLanguagesLine || 'English, French, Malagasy')
                        .split(',')
                        .map((s) => s.trim())
                        .filter(Boolean);

                    pdf.setFillColor(240, 242, 245);
                    pdf.rect(0, 0, pageWidth, pageHeight, 'F');

                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(15);
                    pdf.setTextColor(23, 31, 47);
                    pdf.text(data.profileName, margin, top);

                    pdf.setFont('helvetica', 'normal');
                    pdf.setFontSize(9.5);
                    pdf.setTextColor(59, 68, 83);
                    pdf.text(data.profileRole || profileTitle, margin, top + 5);

                    const imageW = 22;
                    const imageH = 16;
                    const imageX = pageWidth - margin - imageW;
                    const imageY = top - 7;

                    const renderContent = (imageData) => {
                        if (imageData) {
                            pdf.addImage(imageData, 'JPEG', imageX, imageY, imageW, imageH);
                            pdf.setDrawColor(205, 211, 220);
                            pdf.rect(imageX, imageY, imageW, imageH);
                        }

                        let leftY = top + 13;
                        let rightY = top + 13;

                        leftY = addSectionHeader(sectionSkills, leftX, leftY, leftColWidth);
                        leftY = addPlainList(softSkills, leftX, leftY + 0.5, leftColWidth);
                        leftY += 1;

                        leftY = addSectionHeader(sectionTech, leftX, leftY, leftColWidth);
                        leftY = addPlainList(techItems, leftX, leftY + 0.5, leftColWidth);
                        leftY += 1;

                        leftY = addSectionHeader(sectionSpoken, leftX, leftY, leftColWidth);
                        leftY = addPlainList(spokenItems, leftX, leftY + 0.5, leftColWidth);
                        leftY += 1;

                        leftY = addSectionHeader(sectionContact, leftX, leftY, leftColWidth);
                        leftY = addLabelWithLinkValue((language === 'en' ? 'Phone' : 'Téléphone'), data.phoneLine, data.whatsappHref, leftX, leftY + 0.5, leftColWidth);
                        leftY = addLabelWithLinkValue('LinkedIn', data.linkedInLine, data.linkedInHref, leftX, leftY, leftColWidth);
                        leftY = addWrapped('Email : ' + data.emailLine, leftX, leftY, leftColWidth, 'normal', 8.3, [38, 44, 56], 3.8);

                        rightY = addSectionHeader(sectionExperience, rightX, rightY, rightColWidth);
                        data.experiences.forEach((exp) => {
                            rightY = addWrapped(exp.role, rightX, rightY + 0.5, rightColWidth, 'bold', 10.2, [24, 33, 49], 4.25);
                            rightY = addDateBadge(exp.date, rightX, rightY + 0.3, rightColWidth);
                            rightY = addBullets(exp.bullets, rightX, rightY + 0.4, rightColWidth);
                            pdf.setDrawColor(225, 229, 236);
                            pdf.line(rightX + 2, rightY + 0.3, rightX + rightColWidth - 2, rightY + 0.3);
                            rightY += 2.1;
                        });

                        rightY = addSectionHeader(sectionEducation, rightX, rightY + 0.4, rightColWidth);
                        data.education.forEach((edu) => {
                            rightY = addWrapped(edu.date, rightX, rightY + 0.3, rightColWidth, 'bold', 9.3, [31, 41, 59], 4.1);
                            rightY = addWrapped(edu.title, rightX, rightY, rightColWidth, 'normal', 9.1, [38, 44, 56], 4);
                            rightY += 0.8;
                        });

                        pdf.save(text.cvFileName);
                    };

                    resolveFirstImage(data.profileImageCandidates || [data.profileImageSrc]).then(renderContent);
                    return true;

                } catch (err) {
                    console.error('❌ jsPDF generation failed:', err);
                    console.error('Error message:', err.message);
                    console.error('Error stack:', err.stack);
                    
                    // More detailed diagnostics
                    
                    alert('Erreur PDF: ' + err.message + '\n\nVérifiez la console (F12) pour plus de détails.');
                    return false;
                }
            };

            const openTextFallback = (lines, text) => {
                const textLines = lines
                    .map((line) => line.value || '')
                    .filter((val) => val !== '')
                    .join('\n');

                if (textLines.length === 0) {
                    alert('Erreur: Aucun contenu à afficher');
                    return;
                }

                const win = window.open('', '_blank');
                if (!win) {
                    alert('Impossible d\'ouvrir une nouvelle fenêtre. Vérifiez les blocages de pop-up.');
                    return;
                }

                const htmlContent = '<!DOCTYPE html><html><head><meta charset="utf-8"><title>' + text.cvFileName + '</title><style>body{font-family:Arial,sans-serif;padding:20px;line-height:1.6;white-space:pre-wrap;word-wrap:break-word;}</style></head><body>' + textLines.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;') + '</body></html>';
                
                win.document.write(htmlContent);
                win.document.close();
                win.focus();
            };

            const applyLanguage = (lang) => {
                const language = translations[lang] ? lang : 'fr';
                const text = translations[language];

                document.documentElement.lang = language;
                document.title = text.pageTitle;

                setText('.header-subtitle', text.headerSubtitle);
                setText('.header-mono', text.headerRole);
                setText('.brand-subtitle', text.brandRole);

                const navLinks = document.querySelectorAll('.navbar .nav-link');
                if (navLinks.length >= 6) {
                    navLinks[0].textContent = text.navHome;
                    navLinks[1].textContent = text.navAbout;
                    navLinks[2].textContent = text.navResume;
                    navLinks[3].textContent = text.navPortfolio;
                    navLinks[4].textContent = text.navBlog;
                    navLinks[5].textContent = text.navContact;
                }

                const aboutHeaders = document.querySelectorAll('#about h3');
                if (aboutHeaders.length >= 3) {
                    aboutHeaders[0].textContent = text.aboutWho;
                    aboutHeaders[1].textContent = text.aboutInfo;
                    aboutHeaders[2].textContent = text.aboutExpertise;
                }
                setText('#about .about-card .mb-3', text.aboutWhoText);

                const personalInfoLabels = document.querySelectorAll('#about .info span');
                if (personalInfoLabels.length >= 5) {
                    personalInfoLabels[0].textContent = text.aboutBirthdate;
                    personalInfoLabels[1].textContent = text.aboutEmail;
                    personalInfoLabels[2].textContent = text.aboutPhone;
                    personalInfoLabels[3].textContent = text.aboutSkype;
                    personalInfoLabels[4].textContent = text.aboutAddress;
                }

                setText('#about .about-card:last-child h6', text.aboutWebDev);
                const expertiseItems = document.querySelectorAll('#about .about-card:last-child ul li');
                if (expertiseItems.length >= 5) {
                    expertiseItems[0].textContent = text.aboutNeedCollection;
                    expertiseItems[1].textContent = text.aboutNeedAnalysis;
                    expertiseItems[2].textContent = text.aboutDesignEstimate;
                    expertiseItems[3].textContent = text.aboutDebugging;
                    expertiseItems[4].textContent = text.aboutTechWatch;
                }

                setHtml('#resume > .container > h2', '<span class="text-danger">' + text.resumeTitlePrefix + '</span>' + text.resumeTitle);

                const resumeCardHeaders = document.querySelectorAll('#resume .card-header h4');
                if (resumeCardHeaders.length >= 3) {
                    resumeCardHeaders[0].textContent = text.resumeExperience;
                    resumeCardHeaders[1].textContent = text.resumeEducation;
                    resumeCardHeaders[2].textContent = text.resumeSkills;
                }

                const experienceCards = document.querySelectorAll('#resume .experience-list .experience-item .exp-date');
                if (experienceCards.length >= 4) {
                    experienceCards[0].textContent = text.expDate1;
                    experienceCards[1].textContent = text.expDate2;
                    experienceCards[2].textContent = text.expDate3;
                    experienceCards[3].textContent = text.expDate4;
                }

                const educationDates = document.querySelectorAll('#resume .col-md-6.col-lg-4:nth-child(2) .card-body > h6.title.text-danger');
                if (educationDates.length >= 5) {
                    educationDates[0].textContent = text.eduDate1;
                    educationDates[1].textContent = text.eduDate2;
                    educationDates[2].textContent = text.eduDate3;
                    educationDates[3].textContent = text.eduDate4;
                    educationDates[4].textContent = text.eduDate5;
                }

                const experienceItems = document.querySelectorAll('#resume .experience-list .experience-item');
                if (experienceItems.length >= 4) {
                    const firstRole = experienceItems[0].querySelector('.exp-role');
                    const firstDescription = experienceItems[0].querySelector('.exp-description');
                    const secondRole = experienceItems[1].querySelector('.exp-role');
                    const secondDescription = experienceItems[1].querySelector('.exp-description');
                    const thirdRole = experienceItems[2].querySelector('.exp-role');
                    const thirdDescription = experienceItems[2].querySelector('.exp-description');
                    const fourthRole = experienceItems[3].querySelector('.exp-role');
                    const fourthDescription = experienceItems[3].querySelector('.exp-description');

                    if (firstRole) firstRole.textContent = text.roleJavaDeveloper;
                    if (firstDescription) firstDescription.textContent = text.exp0Text;
                    if (secondRole) secondRole.textContent = text.roleProjectCoordinator;
                    if (secondDescription) secondDescription.textContent = text.exp1Text;
                    if (thirdRole) thirdRole.textContent = text.rolePrintingQuote;
                    if (thirdDescription) thirdDescription.textContent = text.exp2Text;
                    if (fourthRole) fourthRole.textContent = text.roleEmbeddedTask;
                    if (fourthDescription) fourthDescription.textContent = text.exp3Text;
                }

                const firstCardLists = document.querySelectorAll('#resume .experience-list .experience-item .exp-bullets');
                if (firstCardLists.length >= 4) {
                    const list1 = firstCardLists[0].querySelectorAll('li');
                    if (list1.length >= 4) {
                        list1[0].textContent = text.exp0Bullet1;
                        list1[1].textContent = text.exp0Bullet2;
                        list1[2].textContent = text.exp0Bullet3;
                        list1[3].textContent = text.exp0Bullet4;
                    }

                    const list2 = firstCardLists[1].querySelectorAll('li');
                    if (list2.length >= 4) {
                        list2[0].textContent = text.exp1Bullet1;
                        list2[1].textContent = text.exp1Bullet2;
                        list2[2].textContent = text.exp1Bullet3;
                        list2[3].textContent = text.exp1Bullet4;
                    }

                    const list3 = firstCardLists[2].querySelectorAll('li');
                    if (list3.length >= 4) {
                        list3[0].textContent = text.exp2Bullet1;
                        list3[1].textContent = text.exp2Bullet2;
                        list3[2].textContent = text.exp2Bullet3;
                        list3[3].textContent = text.exp2Bullet4;
                    }

                    const list4 = firstCardLists[3].querySelectorAll('li');
                    if (list4.length >= 3) {
                        list4[0].textContent = text.exp3Bullet1;
                        list4[1].textContent = text.exp3Bullet2;
                        list4[2].textContent = text.exp3Bullet3;
                    }
                }

                const educationTextBlocks = document.querySelectorAll('#resume .col-md-6.col-lg-4:nth-child(2) .card-body > p:not(.subtitle)');
                if (educationTextBlocks.length >= 7) {
                    educationTextBlocks[0].textContent = text.eduM2;
                    educationTextBlocks[1].textContent = text.eduM1;
                    educationTextBlocks[2].textContent = text.eduBachelor;
                    educationTextBlocks[3].textContent = text.eduSpecialization;
                    educationTextBlocks[4].textContent = text.eduBaccalaureate;
                    educationTextBlocks[5].textContent = text.eduTraining;
                    educationTextBlocks[6].textContent = text.eduTrainingDetail;
                }

                const educationSubtitles = document.querySelectorAll('#resume .col-md-6.col-lg-4:nth-child(2) .card-body > p.subtitle');
                if (educationSubtitles.length >= 5) {
                    educationSubtitles[0].textContent = 'Université Côte d\'Azur';
                    educationSubtitles[1].textContent = 'IT University Andoharanofotsy';
                    educationSubtitles[2].textContent = 'IT University Andoharanofotsy';
                    educationSubtitles[3].textContent = text.eduBaccalaureateSubtitle;
                    educationSubtitles[4].textContent = text.eduTrainingSubtitle;
                }

                const skillHeadings = document.querySelectorAll('#resume .row > .col-lg-4:last-child .card:first-child .card-body h6.title.text-danger');
                if (skillHeadings.length >= 3) {
                    skillHeadings[0].textContent = text.resumeLanguagesLabel;
                    skillHeadings[1].textContent = text.resumeDatabases;
                    skillHeadings[2].textContent = text.resumeOther;
                }

                const spokenLanguages = document.querySelectorAll('#resume .row > .col-lg-4:last-child .card:last-child .card-body h6');
                if (spokenLanguages.length >= 3) {
                    spokenLanguages[0].textContent = text.langEnglish;
                    spokenLanguages[1].textContent = text.langFrench;
                    spokenLanguages[2].textContent = text.langMalagasy;
                }

                setText('.section.bg-dark.py-5 h2', text.freelanceTitle);
                setText('.section.bg-dark.py-5 .btn.bg-primary', text.freelanceButton);

                setText('.contact-form-card .contact-title', text.contactTitle);
                setAttr('#contactForm input[name="name"]', 'placeholder', text.namePlaceholder);
                setAttr('#contactForm input[name="email"]', 'placeholder', text.emailPlaceholder);
                setAttr('#contactForm input[name="subject"]', 'placeholder', text.subjectPlaceholder);
                setAttr('#contactForm textarea[name="message"]', 'placeholder', text.messagePlaceholder);
                setText('#submitBtn .button-text', text.sendButton);
                setText('#successMessage', text.successMessage);
                setText('#errorMessage', text.errorMessage);
                setText('#downloadCvBtn', text.downloadCvButton);

                setText('.contact-info-card .contact-title', text.getInTouch);
                const contactLabels = document.querySelectorAll('.contact-info-card .d-inline');
                if (contactLabels.length >= 3) {
                    const phoneValue = contactLabels[0].querySelector('.text-muted')?.textContent || '+ 261 32 49 084 09';
                    const addressValue = contactLabels[1].querySelector('.text-muted')?.textContent || 'IVC 153 bis Ambodivoanjo Ankaraobato, Antananarivo, Madagascar.';
                    const emailValue = contactLabels[2].querySelector('.text-muted')?.textContent || 'michaeldm034@gmail.com';

                    contactLabels[0].innerHTML = text.phoneLabel + ' <br> <span class="text-muted">' + phoneValue + '</span>';
                    contactLabels[1].innerHTML = text.addressLabel + '<br> <span class="text-muted">' + addressValue + '</span>';
                    contactLabels[2].innerHTML = text.emailLabel + '<br> <span class="text-muted">' + emailValue + '</span>';
                }

                setHtml('.footer .small.mb-0.text-light',
                    '© 2024 ' + text.footerBy + ' <a href="https://DM034.github.io" target="_blank"><span class="text-danger" title="' + text.footerTitle + '">Michael Raharison</span></a>'
                );

                const languageSelect = document.getElementById('languageSelect');
                if (languageSelect) {
                    languageSelect.value = language;
                }

                localStorage.setItem('siteLanguage', language);
            };

            const languageSelect = document.getElementById('languageSelect');
            const downloadCvBtn = document.getElementById('downloadCvBtn');
            
            
            const initialLanguage = localStorage.getItem('siteLanguage') || 'fr';
            applyLanguage(initialLanguage);

            if (languageSelect) {
                languageSelect.addEventListener('change', function (event) {
                    applyLanguage(event.target.value);
                });
            }

            if (downloadCvBtn) {
                downloadCvBtn.addEventListener('click', function () {
                    generateCvPdf(getActiveLanguage());
                });
            } else {
                console.error('❌ downloadCvBtn NOT FOUND! Searched for id="downloadCvBtn"');
            }
        })();
    </script>

